language: rust
rust: nightly

os:
  - linux
  - osx
  - windows

cache:
  yarn: true
  cargo: true
  directories:
  - node_modules
  - $HOME/.cache/electron

addons:
  apt:
    packages:
    - fakeroot
    - rpm

before_install:
  - nvm install lts/carbon

install:
  - yarn

script:
  - yarn lint
  - if test -z "$TRAVIS_TAG"; then travis_wait yarn make; fi

after_success:
  - if test -n "$TRAVIS_TAG"; then yarn publish; fi
